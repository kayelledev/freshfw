<% content_for :custom_scripts do %>
    <%= javascript_include_tag "specific/selected_furniture.js" %>
<% end %>
<main class='room-builder'>
    <section class="main-tabs">
        <div class="l-wrapper">
            <%= link_to 'project info', designer_portal_path, class: "main-tabs__one-tab", id: 'project-info-tab' %>
            <%= link_to 'select items', designer_portal_select_items_path, class: "main-tabs__one-tab", id: 'select-items-tab' %>
            <%= link_to 'room builder', designer_portal_room_builder_path, class: "main-tabs__one-tab main-tabs__one-tab--active", id: 'room-builder-tab' %>
            <%= link_to 'instructions', designer_portal_instructions_path, class: "main-tabs__one-tab", id: 'instructions-tab' %>
        </div>
    </section>
    <div class="l-wrapper">
        <div class="subtabs">
            <a class="subtabs__one-tab subtabs__one-tab--active" data-appearer="selected-furniture" href="#">SELECED FURNITURE</a>
            <a class="subtabs__one-tab" data-appearer="room-layout" href="#">ROOM LAYOUT</a>
            <a class="subtabs__one-tab" data-appearer="furniture-board" href="#">FURNITURE BOARD</a>

            <%= button_tag 'Submit Room', class: "subtabs__btn room-layout-btn layout-submit-room", style: "display: none", data: { url: "#{designer_portal_layout_submit_room_path}" } %>
            <%= button_tag 'Save Layout', class: "subtabs__btn room-layout-btn save-layout", style: "display: none", data: { url: "#{designer_portal_save_room_layout_path}" } %>

            <%= button_tag 'Submit Room', class: "subtabs__btn furniture-board-btn board-submit-room", style: "display: none", data: { url: "#{}" } %>
            <%= button_tag 'Save Board', class: "subtabs__btn furniture-board-btn save-board", style: "display: none", data: { url: "#{designer_portal_save_room_layout_path}" } %>

        </div>
        <div id="selected-furniture" class="js-tabs-block selected-furniture active-tab" data-project-id="<%= @design_project.id %>">
            <div class='selected-furniture-wrapper'>
                <%= render partial: 'selected_furniture' %>
            </div>
        </div>
        <div id="room-layout" class="js-tabs-block room-layout">
            <p class="room-layout__instr-text">Drag the line drawing to the room</p>
            <div class='room-layout-wrapper'>
                <%= render partial: 'room_layout_editor' %>
            </div>
        </div>
        <div id="furniture-board" class="js-tabs-block furniture-board">
            <p class="furniture-board__instr-text">Drag the images to the board</p>
            <div class='furniture-board-wrapper'>
                <%= render partial: 'furniture_board_editor' %>
            </div>
        </div>
    </div>
</main>
<script>
    ;(function() {
        var subtabs = document.querySelectorAll(".subtabs__one-tab");
        var subtabBtns = document.querySelectorAll(".subtabs__btn");
        var roomLayoutSubtabBtns = document.querySelectorAll(".room-layout-btn");
        var furnitureBoardSubtabBtns = document.querySelectorAll(".furniture-board-btn");
        var blocks = document.querySelectorAll(".js-tabs-block");

        for (var i = 0, lim = subtabs.length; i < lim; i += 1) {
            subtabs[i].addEventListener("click", function(e) {
                e.preventDefault();

                for (var x = 0, max = blocks.length; x < max; x += 1) {
                    blocks[x].classList.remove("active-tab");
                };

                for (var y = 0, max = subtabs.length; y < max; y += 1) {
                    subtabs[y].classList.remove("subtabs__one-tab--active");
                };

                var dataText = this.dataset.appearer;
                var block = document.getElementById(dataText);
                block.classList.add("active-tab");
                this.classList.add("subtabs__one-tab--active");

                if (dataText === "selected-furniture") {
                    for (var z = 0, len = subtabBtns.length; z < len; z += 1) {
                        subtabBtns[z].style.display = 'none';
                    };
                } else if (dataText === "room-layout") {
                    for (var z = 0, len = furnitureBoardSubtabBtns.length; z < len; z += 1) {
                        furnitureBoardSubtabBtns[z].style.display = 'none';
                    };
                    for (var z = 0, len = roomLayoutSubtabBtns.length; z < len; z += 1) {
                        roomLayoutSubtabBtns[z].style.display = 'block';
                    };
                    // $(furnitureBoardSubtabBtns).hide();
                    // $(roomLayoutSubtabBtns).show();
                } else if (dataText === "furniture-board") {
                    for (var z = 0, len = roomLayoutSubtabBtns.length; z < len; z += 1) {
                        roomLayoutSubtabBtns[z].style.display = 'none';
                    };
                    for (var z = 0, len = furnitureBoardSubtabBtns.length; z < len; z += 1) {
                        furnitureBoardSubtabBtns[z].style.display = 'block';
                    };

                };
            })
        };
    })();
</script>
